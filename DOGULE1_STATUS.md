# DOGULE1_STATUS.md

## History (read-only)

- **Station 1 – Tooling Check:** Node/pnpm/Git verifiziert, DEV-Setup funktionsfähig.
- **Station 2 – GitHub Setup:** Repo eingerichtet, Remote-Sync getestet, Baseline-Dateien eingecheckt.
- **Station 3 – Tooling & CI:** ESLint, Prettier, Husky, Commitlint, CI-Workflows und Workspace-Struktur.
- **Station 4 – Module Scaffolding:** Alle Module mit Platzhalter-HTML erstellt.
- **Station 5 – Navigation & Shared Styles:** Grundnavigation + `shared.css`.
- **Station 6 – Hash Router:** Einfacher Router lädt Module dynamisch.
- **Station 7 – Unified Layout:** Persistentes Layout mit Header/Navigation/Footer.
- **Station 8 – Standard Module Interfaces:** `export function initModule(container, routeInfo)` als Pflicht.
- **Station 9 – Shared UI Components:** Karten, Buttons, Form-Rows, Notices, Empty States.
- **Station 10 – Central Mock API:** CRUD-Stubs + In-Memory-DB.
- **Station 11 – Kunden CRUD:** Vollständige Kunden-Flows.
- **Station 12 – Mock Data Expansion:** Zusätzliche Datensätze (Hunde, Trainer, Finanzen; Waren noch nicht angelegt).
- **Station 13 – Hunde CRUD** + **13.1 Kunden ↔ Hunde Linking.**
- **Station 14 – Kurse/Hunde/Kunden Linking.**
- **Station 15 – Kunden Finanzen.**
- **Station 16 – Hunde Finanzen.**
- **Station 17 – Kurse Finanzen.**
- **Station 18 – Status Quo Cleanup:** Dashboard/Kunden/Hunde/Kurse vereinheitlicht, ID/Code-Regeln dokumentiert, Vite-Build/NAS-Platzhalter gesetzt.
- **Station 18.1 – Router Stabilization:** Clean Hash Router mit `import.meta.glob`, Fehlerzustände, Navigation-Highlighting.
- **Station 18.2 – Layout Stabilization:** Layout-HTML wird einmalig injiziert, Module mounten ausschließlich in `#dogule-main`.
- **Station 18.3 – Build Stabilization:** Vite-only Dev/Build-Pipeline mit relativen Pfaden, keine hybriden Template-Flows.
- **Station 18.4 – Mock DB Consolidation:** Alle Mock-Daten in `modules/shared/api/db/index.js`, CRUD-Helper nutzen nur dieses Objekt, Integrity-Check aktiv.
- **Phase 1 QA:** Checklist in `PHASE1_QA.md` angelegt; wird fortlaufend gepflegt, bis alle Punkte verifiziert sind.
- **Station 19 – Module Self-Test Preparation:** `PHASEA_SELFTEST_CHECKLIST.md` erstellt und als Pflichtgrundlage in MASTER verankert; Station 19 beendet, Phase A Module können in Station 20 ff. nach den Self-Tests fortgesetzt werden.
- **Station 20 – Dashboard Phase A:** Dashboard auf Daten aus der zentralen Mock-API umgestellt (Kunden/Hunde/Kurse-Zählungen), Fallback-Texte vereinheitlicht, Scroll/Focus beim Laden, Status-Karte via Shared Notice, Phase-A-Selftest für Dash abgeschlossen; MASTER ergänzt, dass Module nur nach vollständigem GUI + manueller Freigabe des Nutzers als abgeschlossen gelten.
- **Station 24 – Trainer Single-Module Completion:** Branch `feature/station24-trainer`. Trainer-Modul auf Phase-A-Stand gebracht: saubere h1/h2-Hierarchie, Router-Mount bleibt unverändert, Shared-Komponenten durchgängig genutzt. ID-System am Master ausgerichtet (Trainer-IDs nun API-seitig sequenziell `t<n>`, UI nur read-only Vorschau), Code-Override-Toggle auf Create/Edit, Verfügbarkeiten-Eingabe als interaktives Textarea mit Persistenz. Formular-Buttons an die Form gebunden (`requestSubmit`), sodass CRUD (Create/Edit/Delete) wieder auslösbar ist; Detail/List zeigen ID/Code/Kontakt/Notizen/Verfügbarkeiten. Manual UI validation bestätigt 100 % Phase-A-Readiness (CRUD, Validierung, Empty/Error States, Navigation, Shared-Styles). Lint/Build laufen grün.
- **Station 25 – Finanzen Phase-A (Listen/Detail/Filter) in Progress:** Branch `feature/station25-finanzen`. Finanzen-Modul mit Phase-A-Skelett ergänzt: `initModule` mit Scroll/Fokus/Hash-Segmente, Loading/Error/Empty via Shared Notices, Summary-Karte (Summe Zahlungen/Offen/Saldo), Filter-Karte (Kunde/Typ), Einträge-Tabelle mit Kundenauflösung und Hash-Details, Detail-Card mit Kunde-Link + Back-Link. Keine CRUD-Formulare/Deletes (für Station 27 vorgesehen). Manuell geprüft: `#/finanzen` und `#/finanzen/<id>` laden ohne Console-Errors. `pnpm lint` ✅, `pnpm build` ✅.
- **Station 27 – Finanzen Single-Module Completion (Phase A):** Branch `feature/station27-finanzen`. Finanzen-Modul auf vollständige CRUD-Flows gebracht: Hash-Routen `#/finanzen`/`new`/`<id>`/`<id>/edit`, Shared-Formular mit ID read-only + Code-Override-Toggle, Kunde/Typ/Betrag/Datum/Beschreibung-Felder, Filter + Summary behalten, Detail mit Edit/Delete-Actions, Inline-Löschbestätigung, Typen auf „Bezahlt/Offen“ vereinheitlicht, Kundenlabels aus zentraler Map. Shared Notices/Empty, Fokus/Scroll-Reset, German UI. Self-Test: manuell ✅ (Listen → Create → Detail → Edit → Delete → Refresh), Console clean. Tests: `pnpm lint` ✅, `pnpm test` ✅, `pnpm build` ✅.
- **Station 28 – Waren Single-Module Completion (Phase A):** Branch `feature/station28-waren`. Waren-Modul auf vollständige Phase-A-CRUD gebracht: Hash-Routen `#/waren`/`new`/`<id>`/`<id>/edit`, Listen/Detail/Form/Delete über Shared Cards/Buttons/Notices/Form-Rows, German UI, Loading/Error/Empty/Not-Found States, Fokus/H1/H2 korrekt, kein Routing- oder Konsolenrauschen. CRUD nutzt die zentrale Waren-API (list/get/create/update/delete), keine Relationen zu Kunden/Finanzen/Kurse. Manual Self-Test ✅ (CRUD end-to-end inkl. Delete), `pnpm lint` ✅, `pnpm build` ✅.
- **Station 29 – Connect Kunden ↔ Hunde:** Branch `feature/station29-kunden-hunde`. Scope: bidirektionale Navigation Kunden↔Hunde in Phase-B-Stil ohne Router/Init-Änderungen. Änderungen: Kunden-Detail zeigt verlinkte Hunde mit ID/Code, Hunde-Liste/Detail verlinkt Besitzer inkl. Rücksprung nach Delete, Hund-API erzwingt gültige `kundenId` bei Create/Update, Self-Test-Checkliste um Station-29-Block ergänzt. Tests: `runIntegrityCheck` ✅, `pnpm lint` ✅, `pnpm test` ✅, `pnpm build` ✅. UI deutsch, Links nur `#/kunden/<id>`/`#/hunde/<id>`, keine weiteren Module betroffen.
- **Station 30 – Connect Kunden ↔ Kurse:** Branch `feature/station30-kunden-kurse`. Hunde-only Teilnehmermodell in Kurse (kundenIds entfernt), API validiert `hundIds`, Integrity-Check aktualisiert. Kunden-Detail verlinkt Kurse nur über Hunde. Kurs-UI zeigt Teilnehmerkunden abgeleitet aus Hundebesitzern. Neues Typeahead-Feld im Kurs-Formular: Tippen nach Kunde oder Hund zeigt zwei Spalten (Kunden + Hunde), Kunde-Klick fügt alle eigenen Hunde hinzu, Hund-Klick fügt Einzelhund hinzu, Chips/Leeren möglich, leere Auswahl erlaubt. Tests: `pnpm lint` ✅, `pnpm vitest run` ✅, `pnpm build` ✅. PR erstellt, Station abgeschlossen.
- **Station 31 – Connect Hunde ↔ Kurse:** Branch `feature/station31-hunde-kurse`. Hunde-Detail zeigt verknüpfte Kurse inkl. Links; Kurs-Detail listet teilnehmende Hunde inkl. Besitzerinfos. Alle Hundedarstellungen zeigen nun Besitzer (Code/Name) + Ort aus Kundenadresse zur eindeutigen Zuordnung. Kurs-Formular-Suche/Chips zeigen ebenfalls Besitzer+Ort. Tests: `pnpm lint` ✅, `pnpm vitest run` ✅, `pnpm build` ✅. Warten auf PR.
- **Station 32 – Connect Kurse ↔ Trainer:** Arbeit auf Branch `feature/station31-hunde-kurse` fortgesetzt. Trainer↔Kurs-Verknüpfung formalisiert: Kurse laden/prüfen Trainerliste, zeigen verlinkte Trainerkarte mit ID/Code/Kontakt, Trainer-Auswahl validiert (UI-Fehler bei ungültigem Trainer). Trainer-Detail listet zugewiesene Kurse; Trainer-Löschen blockiert bei Zuweisungen und zeigt aktuelle Kursliste, Erfolgsfall triggert Integrity-Check. Einheitlicher Primär-Button „Neuer …“ in Aktionen-Karten für Kurse/Kunden/Hunde. Tests: `pnpm lint` ✅, `pnpm vitest run` ✅, `pnpm build` ✅. Manuelle Checks: Kursdetail-Link zum Trainer, Rückliste der Kurse im Trainerdetail, Kurs-Create/Edit mit Trainer, Delete-Guard für Trainer mit Kursen.
- **Station 32a – Build-Fix Trainer FK Export:** Branch `feature/station31-hunde-kurse`. CI-Build scheiterte, weil `getKurseForTrainer` nicht exportiert war und Trainer-FK-Checks fehlten. Fix: `modules/shared/api/kurse.js` exportiert `getKurseForTrainer` und erzwingt Trainer-Integrität; `modules/shared/api/trainer.js` blockiert Delete bei Kurs-Zuweisungen; Integrity-Check erweitert. Tests nach Fix: `pnpm lint` ✅, `pnpm vitest run` ✅, `pnpm build` ✅. Commit `fix: enforce trainer FK and export getKurseForTrainer` gepusht; CI sollte jetzt durchlaufen.
- **Station 33 – Connect Kurse ↔ Kalender:** Branch `feature/station33-kurse-kalender`. Kalender wird nun aus Kursen gespeist (Create/Update/Delete). API: `kalender` upsert/remove per Kurs, `syncKalenderWithKurse` räumt Waisen auf. Zeiten lokal → ISO, payload nur MASTER-Felder. Kalender-UI: Event-Blocks verlinken zu `#/kurse/<id>`, Event-Detail zeigt Kurs-Infos + Buttons „Zum Kurs/Zum Tag“. Tests: `pnpm lint` ✅, `pnpm vitest run` ✅, `pnpm build` ✅. Manuelle Checks: Kurs erstellen → Event erscheint; Kurs-Zeit ändern → Event verschiebt sich; Löschen nach Entlinken von Teilnehmern entfernt Event; Event-Detail mit Kurs-Link funktioniert.
- **Station 35 – Connect Trainer ↔ Finanzen (re-scoped from Kunden ↔ Finanzen):** Branch `feature/station35-trainer-finanzen`. Finanzen bleiben read-only, bekommen optional `kursId` (im Schema + Seed) zur Laufzeit-Derivation: List/Detail zeigen Trainer-Meta/Links für Kurs-Zahlungen; Trainer-Detail hat Umsatz-Karte (Summen Bezahlt/Offen/Saldo + letzte Einträge) mit Links zurück zu Finanzen. Neue API-Helper `resolveFinanzenWithRelations`/`getFinanzenReportForTrainer`, Integrity-Check validiert `kursId` wenn vorhanden. Tests: `pnpm lint` ✅, `pnpm vitest run --root . modules/shared/api/finanzen.trainer.test.js` ✅, `pnpm build` ✅; manuelle Checks: Kurs-gebundene Zahlungen zeigen Trainer, Kurs ohne Trainer zeigt Hinweis, nicht kursgebundene Zahlungen bleiben unverändert, Trainer-Umsatzkarte zeigt leeren Zustand ohne Umsatz.
- **Station 35.1 – CI Lint Fix (Trainer ↔ Finanzen):** Branch `feature/station35-trainer-finanzen`. Nach dem Merge auf den Branch meldete CI einen Lint-Fehler (`no-unused-vars`) durch ein altes Hilfs-Wrapper `formatScheduleTimeRange`, das nicht mehr genutzt wurde. Fix: Helper vollständig entfernt, Aufruf bleibt bei `formatTimeRange`. Keine funktionalen Änderungen, nur Code-Cleanup. Commit `chore: remove unused formatScheduleTimeRange`. Tests: `pnpm lint` ✅ (lokal), Branch erneut gepusht; CI-Lint sollte damit grün sein.

## Active Station

**Station 35 – Connect Trainer ↔ Finanzen (re-scoped from Kunden ↔ Finanzen):** Branch `feature/station35-trainer-finanzen`. Status: implementiert und lokal getestet. Scope: Finanzen bleiben read-only, erhalten aber Kurs-/Trainer-Derivation via `kursId`; Finanzen-Liste zeigt Trainer-Meta/Links, Detail hat Trainer-Karte (aus Kurs), Trainer-Detail hat Umsatz-Karte (Summen + letzte Einträge) für kursgebundene Zahlungen. Keine Schema-Änderungen außer optional `kursId`; alle Trainer-Zuordnungen werden zur Laufzeit abgeleitet. Tests: `pnpm lint` ✅, `pnpm vitest run --root . modules/shared/api/finanzen.trainer.test.js` ✅, `pnpm build` ✅, manuelle UI-Checks ✅ (Trainer-/Finanzen-Ansichten mit/ohne Kurs/Trainer).

### Status-Update-Kadenz

- Nach jedem gemergten PR und zum Ende jeder Station `DOGULE1_STATUS.md` ergänzen.
- Immer Branch/PR, Zusammenfassung, Testergebnisse (lint/test/build), offene Risiken/Nächste Schritte notieren.
- Der detaillierte aktuelle Arbeitsstand liegt zusätzlich in `CODEX_STEP_LOG.md`.

### Aktive Branches/PRs

- `feature/station24-trainer` → PR “Station 24 – Trainer Single-Module Completion” → Ziel: `main`
- `feature/station27-finanzen` → PR “Station 27 – Finanzen Single-Module Completion” → Ziel: `main`
- `feature/station28-waren` → PR “Station 28 – Waren Single-Module Completion” → Ziel: `main`
- `feature/station29-kunden-hunde` → PR “Station 29 – Connect Kunden ↔ Hunde” → Ziel: `main`
